<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptLink - AI Collaboration on Autopilot</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --logo-primary: #00B4D8;
            --logo-secondary: #0077B6;
            --logo-accent: #00D4C7;
            --logo-deep: #023E8A;
            --bg-dark: #0a0f1c;
            --bg-darker: #060b14;
            --bg-card: rgba(15, 23, 42, 0.8);
            --border-color: rgba(59, 130, 246, 0.2);
            --separator-color: rgba(248, 250, 252, 0.8);
            --icon-contrast: rgba(248, 250, 252, 0.9);
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Playfair Display', serif;
            background: linear-gradient(135deg, var(--bg-darker) 0%, var(--bg-dark) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding-top: 100px;
        }

        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 110px;
            background: rgba(6, 11, 20, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 2px solid var(--separator-color);
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 16px 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 18px;
            margin-right: 48px;
        }

        .logo-icon {
    width: 90px !important;
    height: 90px !important;
    max-width: 90px !important;
    max-height: 90px !important;
}

        .logo-icon:hover {
            filter: drop-shadow(0 0 20px rgba(0, 180, 216, 0.6));
            transform: scale(1.05);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 3px;
        }

        .logo-title {
            font-family: 'Playfair Display', serif;
            font-size: 26px;
            font-weight: 700;
            color: var(--logo-primary);
            line-height: 1;
            text-shadow: 0 0 8px rgba(0, 180, 216, 0.3);
        }

        .logo-subtitle {
            font-family: 'Playfair Display', serif;
            font-size: 13px;
            font-weight: 400;
            color: var(--separator-color);
            line-height: 1;
            opacity: 0.9;
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: 36px;
            flex: 1;
        }

        .nav-link {
            font-family: 'Playfair Display', serif;
            font-size: 15px;
            font-weight: 500;
            color: var(--text-secondary);
            text-decoration: none;
            padding: 10px 18px;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 180, 216, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .nav-link:hover {
            color: var(--logo-primary);
            background: rgba(0, 180, 216, 0.08);
            transform: translateY(-1px);
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .dropdown {
            position: relative;
        }

        .dropdown-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .dropdown-toggle i {
            font-size: 10px;
            transition: transform 0.3s ease;
        }

        .dropdown.active .dropdown-toggle i {
            transform: rotate(180deg);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 12px;
            min-width: 220px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(16px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .dropdown-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: block;
            padding: 14px 18px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 400;
            transition: all 0.3s ease;
            border-radius: 8px;
            margin: 4px 8px;
        }

        .dropdown-item:hover {
            background: rgba(0, 180, 216, 0.1);
            color: var(--logo-primary);
            transform: translateX(4px);
        }

        .status-section {
            display: flex;
            align-items: center;
            gap: 28px;
            margin-left: auto;
        }

        .system-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 18px;
            background: rgba(0, 180, 216, 0.1);
            border: 1px solid var(--logo-accent);
            border-radius: 22px;
            box-shadow: 0 0 12px rgba(0, 212, 199, 0.2);
        }

        .status-dot {
            width: 9px;
            height: 9px;
            border-radius: 50%;
            background: var(--logo-accent);
            box-shadow: 0 0 8px rgba(0, 212, 199, 0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { 
                opacity: 1;
                transform: scale(1);
            }
            50% { 
                opacity: 0.8;
                transform: scale(1.1);
            }
        }

        .status-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .credits-display {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 18px;
            background: rgba(100, 116, 139, 0.15);
            border: 1px solid var(--text-muted);
            border-radius: 22px;
            box-shadow: 0 0 8px rgba(100, 116, 139, 0.2);
        }

        .credits-icon {
            color: var(--text-muted);
            font-size: 13px;
        }

        .credits-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .credits-amount {
            font-weight: 600;
            color: var(--text-primary);
        }

        .upgrade-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 16px;
            padding: 6px 12px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            box-shadow: 0 2px 8px rgba(0, 180, 216, 0.3);
        }

        .upgrade-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 180, 216, 0.4);
            background: linear-gradient(135deg, var(--accent-secondary), var(--accent-primary));
        }

        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px 24px;
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            position: relative;
        }

        .card:hover {
            border-color: rgba(0, 180, 216, 0.3);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(0, 180, 216, 0.2);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .card-title-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-title {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            font-weight: 600;
            color: var(--logo-primary);
            text-shadow: 0 0 8px rgba(0, 180, 216, 0.2);
        }

        .card-icon {
            color: var(--icon-contrast);
            font-size: 18px;
        }

        /* ===== CLEAN SECTION HELP SYSTEM ===== */
        .section-help {
            position: relative;
            display: inline-block;
        }

        .help-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: rgba(0, 180, 216, 0.15);
            border: 1px solid rgba(0, 180, 216, 0.3);
            border-radius: 6px;
            color: var(--logo-primary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .help-button:hover {
            background: rgba(0, 180, 216, 0.25);
            border-color: var(--logo-primary);
            opacity: 1;
            transform: scale(1.05);
        }

        .help-panel {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            width: 400px;
            max-width: 90vw;
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.6);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 999999;
        }

        /* Fix for top 3 tooltips that go underneath other elements */
        #orchestration-help.help-panel.active,
        #prompt-help.help-panel.active,
        #advisor-help.help-panel.active {
            position: fixed !important;
            top: auto !important;
            bottom: 20px !important;
            right: 20px !important;
            z-index: 999999 !important;
        }

        .help-panel.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .help-panel h3 {
            color: var(--logo-primary);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 8px;
        }

        .help-item {
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.1);
        }

        .help-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .help-item-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 13px;
            margin-bottom: 4px;
        }

        .help-item-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* ===== VOICE DICTATION BUTTON ===== */
        .voice-btn {
            position: relative;
            width: 40px;
            height: 40px;
            background: rgba(0, 180, 216, 0.1);
            border: 1px solid var(--logo-primary);
            border-radius: 50%;
            color: var(--logo-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .voice-btn:hover {
            background: rgba(0, 180, 216, 0.2);
            transform: scale(1.05);
        }

        .voice-btn.recording {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--error);
            color: var(--error);
            animation: pulse 1s infinite;
        }

        .voice-btn.recording::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border: 2px solid var(--error);
            border-radius: 50%;
            animation: ripple 1s infinite;
        }

        @keyframes ripple {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.4);
                opacity: 0;
            }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-family: 'Playfair Display', serif;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.05);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--logo-primary), var(--logo-secondary));
            color: white;
            box-shadow: 0 4px 16px rgba(0, 180, 216, 0.3), 0 0 0 1px rgba(0, 180, 216, 0.2);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 180, 216, 0.4), 0 0 0 1px rgba(0, 180, 216, 0.3);
        }

        .btn-secondary {
            background: rgba(75, 85, 99, 0.5);
            color: var(--text-secondary);
            border: 1px solid rgba(75, 85, 99, 0.7);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.05);
        }

        .btn-secondary:hover {
            background: rgba(75, 85, 99, 0.8);
            color: var(--text-primary);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.1);
        }

        .btn-secondary.active {
            background: linear-gradient(135deg, var(--logo-primary), var(--logo-secondary));
            color: white;
            box-shadow: 0 4px 16px rgba(0, 180, 216, 0.3), 0 0 0 1px rgba(0, 180, 216, 0.2);
        }

        .agent-container {
            position: relative;
            transition: all 0.3s ease;
        }

        .agent-container.active {
            animation: agentPulse 2s infinite;
        }

        @keyframes agentPulse {
            0%, 100% {
                border-color: var(--logo-primary);
                box-shadow: 0 0 20px rgba(0, 180, 216, 0.3), 0 0 0 1px rgba(0, 180, 216, 0.2);
            }
            50% {
                border-color: var(--logo-accent);
                box-shadow: 0 0 30px rgba(0, 212, 199, 0.5), 0 0 0 1px rgba(0, 212, 199, 0.3);
            }
        }

        .agent-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .agent-title {
            font-family: 'Playfair Display', serif;
            font-size: 18px;
            font-weight: 600;
            color: var(--logo-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .agent-title i {
            color: var(--icon-contrast);
            font-size: 18px;
        }

        .agent-status {
            font-size: 13px;
            font-weight: 500;
            padding: 4px 12px;
            border-radius: 12px;
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .agent-status.working {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border-color: var(--warning);
        }

        .agent-status.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border-color: var(--error);
        }

        .toolbar-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(75, 85, 99, 0.3);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 8px;
            color: var(--icon-contrast);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .toolbar-btn:hover {
            background: rgba(0, 180, 216, 0.2);
            border-color: var(--logo-primary);
            color: var(--logo-primary);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* ===== ENHANCED MOBILE RESPONSIVENESS ===== */
        @media (max-width: 768px) {
            .navbar {
                height: 80px;
                padding: 12px 16px;
            }
            
            .logo-section {
                margin-right: 16px;
            }
            
            .nav-menu {
                gap: 20px;
            }
            
            .nav-menu .nav-link {
                padding: 8px 12px;
                font-size: 14px;
            }
            
            .main-content {
                padding: 20px 16px;
                gap: 24px;
            }
            
            .card {
                padding: 16px;
            }
            
            .help-panel {
                width: 320px;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 13px;
            }
            
            .voice-btn {
                width: 36px;
                height: 36px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding-top: 80px;
            }
            
            .navbar {
                height: 70px;
                padding: 8px 12px;
            }
            
            .logo-icon {
                width: 40px;
                height: 40px;
            }
            
            .logo-title {
                font-size: 20px;
            }
            
            .logo-subtitle {
                font-size: 11px;
            }
            
            .nav-menu {
                gap: 12px;
            }
            
            .main-content {
                padding: 16px 12px;
                gap: 20px;
            }
            
            .card {
                padding: 12px;
            }
            
            .card-title {
                font-size: 18px;
            }

            .help-panel {
                width: 280px;
            }
        }

        /* ===== FORM STYLING ===== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: flex;
            align-items: center;
            font-family: 'Playfair Display', serif;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Playfair Display', serif;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--logo-primary);
            box-shadow: 0 0 0 3px rgba(0, 180, 216, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
            font-family: 'Playfair Display', serif;
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Playfair Display', serif;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--logo-primary);
            box-shadow: 0 0 0 3px rgba(0, 180, 216, 0.1);
        }

        /* ===== GRID LAYOUTS ===== */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .grid-5 {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
        }

        .grid-6 {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 12px;
        }

        /* ===== RESPONSIVE GRID ADJUSTMENTS ===== */
        @media (max-width: 1024px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .grid-4 {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .grid-6 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .plans-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto;
                max-width: 400px;
            }
        }

        /* ===== ENHANCED VISUAL POLISH ===== */
        .conversation-area {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
        }

        .message-bubble {
            margin-bottom: 16px;
            padding: 12px 16px;
            border-radius: 10px;
            border-left: 4px solid;
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .message-agent-a {
            background: rgba(0, 180, 216, 0.1);
            border-left-color: var(--logo-primary);
        }

        .message-agent-b {
            background: rgba(0, 212, 199, 0.1);
            border-left-color: var(--logo-accent);
        }

        .message-human {
            background: rgba(100, 116, 139, 0.1);
            border-left-color: var(--text-muted);
        }

        .message-system {
            background: rgba(107, 114, 128, 0.1);
            border-left-color: var(--text-muted);
        }

        .message-sender {
            font-weight: 600;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .message-content {
            color: var(--text-primary);
            line-height: 1.5;
            word-wrap: break-word;
        }

        .message-time {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
            opacity: 0.7;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
            color: var(--icon-contrast);
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .empty-state p {
            font-size: 14px;
            opacity: 0.8;
        }

        /* ===== ENHANCED PROMPT INPUT WITH VOICE ===== */
        .prompt-input-container {
            position: relative;
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .prompt-input-container .form-textarea {
            flex: 1;
        }
    </style>
</head>
<body>
    <nav class="navbar" style="min-height: 108px; height: 108px; padding: 20px 28px;">
    <div class="logo-section" style="gap: 16px; margin-right: 36px;">
        <img src="logo.png" alt="PromptLink Logo" class="logo-icon" style="width: 52px; height: 52px; object-fit: contain; display: block;">
        <div class="logo-text">
            <div class="logo-title">PromptLink</div>
            <div class="logo-subtitle">AI Collaboration on Autopilot</div>
        </div>
    </div>

    <div class="nav-menu" style="gap: 24px;">
        <a href="#" class="nav-link" style="padding: 8px 14px; font-size: 14px;">Platform</a>
        <a href="#" class="nav-link" style="padding: 8px 14px; font-size: 14px;">About</a>
        <a href="#" class="nav-link" style="padding: 8px 14px; font-size: 14px;">How It Works</a>
        <a href="#" class="nav-link" style="padding: 8px 14px; font-size: 14px;">FAQ</a>
        
        <div class="dropdown">
            <div class="nav-link dropdown-toggle" style="padding: 8px 14px; font-size: 14px;">
                <span>More</span>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="dropdown-menu">
                <a href="#" class="dropdown-item">AI Magna Carta</a>
                <a href="#" class="dropdown-item">Documentation</a>
                <a href="#" class="dropdown-item">The Papers</a>
                <a href="#" class="dropdown-item">8-Day Journey</a>
                <a href="#" class="dropdown-item">Investors</a>
                <a href="#" class="dropdown-item">Partners</a>
                <a href="#" class="dropdown-item">Diagnostic Tools</a>
                <a href="#" class="dropdown-item">Contact</a>
            </div>
        </div>
    </div>

    <div class="status-section" style="gap: 20px;">
        <div class="system-status">
            <div class="status-dot"></div>
            <div class="status-text">System Online</div>
        </div>
        <div class="credits-display">
            <i class="fas fa-coins credits-icon"></i>
            <div class="credits-text">Credits: <span class="credits-amount">2,500</span></div>
            <button class="upgrade-btn" onclick="showUpgradeModal()">
                <i class="fas fa-arrow-up"></i> Upgrade
            </button>
        </div>
    </div>
</nav>

    <main class="main-content">
        <section class="card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-cogs card-icon"></i>
                    <h2 class="card-title">Orchestration Mode</h2>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('orchestration-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="orchestration-help" class="help-panel">
                        <h3>Orchestration Mode Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">Manual Relay</div>
                            <div class="help-item-desc">You control when each agent responds. Perfect for guided conversations and step-by-step analysis.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Autonomous</div>
                            <div class="help-item-desc">Agents talk to each other automatically for the set number of rounds. Great for exploring ideas and debates.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Agent A Only</div>
                            <div class="help-item-desc">Focus on just Agent A for concentrated analysis. Perfect when you need deep insight from one specific AI model.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Agent B Only</div>
                            <div class="help-item-desc">Focus on just Agent B for concentrated analysis. Perfect when you need deep insight from one specific AI model.</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="grid-4">
                <button class="btn btn-primary orchestration-mode" data-mode="manual">
                    <i class="fas fa-hand-paper"></i>
                    <div>
                        <div>Manual Relay</div>
                        <small>Human controlled</small>
                    </div>
                </button>
                <button class="btn btn-secondary orchestration-mode" data-mode="autonomous">
                    <i class="fas fa-robot"></i>
                    <div>
                        <div>Autonomous</div>
                        <small>AI self-directed</small>
                    </div>
                </button>
                <button class="btn btn-secondary orchestration-mode" data-mode="human-sim-a">
                    <i class="fas fa-user-robot"></i>
                    <div>
                        <div>Human Simulator + A</div>
                        <small>AI proxy with Agent A</small>
                    </div>
                </button>
                <button class="btn btn-secondary orchestration-mode" data-mode="human-sim-b">
                    <i class="fas fa-user-robot"></i>
                    <div>
                        <div>Human Simulator + B</div>
                        <small>AI proxy with Agent B</small>
                    </div>
                </button>
                <button class="btn btn-secondary orchestration-mode" data-mode="human-sim-dual">
                    <i class="fas fa-users-cog"></i>
                    <div>
                        <div>Human Simulator + Dual</div>
                        <small>AI proxy with both agents</small>
                    </div>
                </button>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-edit card-icon"></i>
                    <h2 class="card-title">Initial Prompt</h2>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('prompt-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="prompt-help" class="help-panel">
                        <h3>Initial Prompt Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">Prompt Input</div>
                            <div class="help-item-desc">Enter your starting message here. This will be the foundation for the AI conversation. Be specific about what you want to explore or discuss.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Voice Input</div>
                            <div class="help-item-desc">Click the microphone button to use voice dictation for hands-free prompt entry. Works in Chrome, Edge, and Safari.</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="prompt-input-container">
                    <textarea 
                        id="initial-prompt" 
                        class="form-input form-textarea" 
                        placeholder="Enter your prompt to start the AI conversation...">Let's discuss the future of AI and the developments in the next six months and what significance will those massive developments have on the overall timeline and advancements</textarea>
                    <button id="voice-input-btn" class="voice-btn" title="Voice Input">
                        <i class="fas fa-microphone"></i>
                    </button>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-lightbulb card-icon"></i>
                    <h2 class="card-title">AI Advisor</h2>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('advisor-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="advisor-help" class="help-panel">
                        <h3>AI Advisor Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">Conversation Styles</div>
                            <div class="help-item-desc">Choose from 6 optimized conversation modes: Free Discussion, Brainstorm, Debate, Strategy, Technical, and Compliance.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">AI Recommendations</div>
                            <div class="help-item-desc">Automatically fills both agent dropdowns with the optimal AI pairing for your selected conversation style.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Mode Benefits</div>
                            <div class="help-item-desc">Each mode optimizes agent selection and conversation flow for different types of interactions and outcomes.</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="grid-6">
                <button class="btn btn-secondary advisor-mode" data-mode="discussion">
                    Free Discussion
                </button>
                <button class="btn btn-secondary advisor-mode" data-mode="brainstorm">
                    Brainstorm
                </button>
                <button class="btn btn-secondary advisor-mode" data-mode="debate">
                    Debate
                </button>
                <button class="btn btn-secondary advisor-mode" data-mode="strategy">
                    Strategy
                </button>
                <button class="btn btn-secondary advisor-mode" data-mode="technical">
                    Technical
                </button>
                <button class="btn btn-secondary advisor-mode" data-mode="compliance">
                    Compliance
                </button>
            </div>
            <div style="margin-top: 16px;">
                <button id="get-recommendations" class="btn btn-primary">
                    <i class="fas fa-magic"></i>
                    Get AI Recommendations
                </button>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-user-cog card-icon"></i>
                    <h2 class="card-title">Human Controller</h2>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('controller-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="controller-help" class="help-panel">
                        <h3>Human Controller Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">Session Controls</div>
                            <div class="help-item-desc">Start, pause, stop, and manage AI conversations. Control the flow and timing of agent interactions.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Rounds Setting</div>
                            <div class="help-item-desc">Set the number of back-and-forth exchanges in autonomous mode. More rounds = deeper exploration.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Human Interjection</div>
                            <div class="help-item-desc">Add your own guidance during conversations. Perfect for steering discussions or asking follow-up questions.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Voice Input</div>
                            <div class="help-item-desc">Use voice dictation for hands-free operation when adding guidance or instructions.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid-5" style="margin-bottom: 24px;">
                <button id="start-session" class="btn btn-primary">
                    <i class="fas fa-play"></i>
                    Start Session
                </button>
                <button id="next-step" class="btn btn-secondary" disabled>
                    <i class="fas fa-step-forward"></i>
                    Next Step
                </button>
                <button id="pause-session" class="btn btn-secondary" disabled>
                    <i class="fas fa-pause"></i>
                    Pause
                </button>
                <button id="stop-session" class="btn btn-secondary" disabled>
                    <i class="fas fa-stop"></i>
                    Stop
                </button>
                <button id="clear-all" class="btn btn-secondary">
                    <i class="fas fa-trash"></i>
                    Clear All
                </button>
            </div>

            <div class="grid-3" style="margin-bottom: 24px;">
                <div class="form-group">
                    <label class="form-label">Rounds (Autonomous Mode)</label>
                    <input id="rounds-input" type="number" value="5" min="1" max="25" class="form-input" placeholder="Enter 1-25 rounds">
                </div>
                <div class="form-group">
                    <label class="form-label">Current Mode</label>
                    <div id="current-mode" class="form-input" style="background: rgba(0, 180, 216, 0.1); color: var(--logo-primary);">Manual Relay</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Session Status</label>
                    <div id="session-status" class="form-input" style="background: rgba(107, 114, 128, 0.1); color: var(--text-muted);">Inactive</div>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Interject with custom message or guidance...</label>
                <div class="prompt-input-container">
                    <textarea id="human-input" class="form-input form-textarea" style="height: 80px;" placeholder="Add guidance or instructions for the agents..."></textarea>
                    <button id="voice-human-btn" class="voice-btn" title="Voice Input">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <button id="send-human-message" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </section>

        <section class="grid-2">
            <div class="card agent-container" id="agent-a-container">
                <div class="agent-header">
                    <div class="agent-title">
                        <i class="fas fa-robot"></i>
                        Agent A
                    </div>
                    <div class="agent-status" id="agent-a-status">Ready</div>
                    <div class="section-help">
                        <div class="help-button" onclick="toggleHelp('agent-a-help')">
                            <i class="fas fa-question"></i>
                        </div>
                        <div id="agent-a-help" class="help-panel">
                            <h3>Agent A Guide</h3>
                            <div class="help-item">
                                <div class="help-item-title">AI Model Selection</div>
                                <div class="help-item-desc">Choose from 11 different AI models, each with unique strengths and capabilities.</div>
                            </div>
                            <div class="help-item">
                                <div class="help-item-title">Agent Toolbar</div>
                                <div class="help-item-desc">Reset, refresh, copy, edit, download responses, and access agent settings.</div>
                            </div>
                            <div class="help-item">
                                <div class="help-item-title">Status Indicators</div>
                                <div class="help-item-desc">Monitor agent status: Ready, Thinking, or Error states with visual feedback.</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <select id="agent-a-select" class="form-select">
                    <option value="">Select Agent A...</option>
                    <option value="gpt4o">GPT-4o</option>
                    <option value="deepseek">DeepSeek R1</option>
                    <option value="llama">Meta Llama 3.3</option>
                    <option value="mistral">Mistral Large</option>
                    <option value="gemini2">Gemini 2.0 Flash</option>
                    <option value="perplexity">Perplexity Pro</option>
                    <option value="gemini15">Gemini Pro 1.5</option>
                    <option value="commandr">Command R+</option>
                    <option value="qwen">Qwen 2.5 72B</option>
                </select>
                </div>

                <div class="agent-toolbar" style="display: flex; gap: 8px; margin-bottom: 16px;">
                    <button class="toolbar-btn" title="Reset Agent A" onclick="resetAgent('a')">
                        <i class="fas fa-home"></i>
                    </button>
                    <button class="toolbar-btn" title="Refresh Agent A" onclick="refreshAgent('a')">
                        <i class="fas fa-redo"></i>
                    </button>
                    <button class="toolbar-btn" title="Copy Response" onclick="copyResponse('a')">
                        <i class="fas fa-copy"></i>
                    </button>
                    <button class="toolbar-btn" title="Edit Response" onclick="editResponse('a')">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="toolbar-btn" title="Download Response" onclick="downloadResponse('a')">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="toolbar-btn" title="Agent Settings" onclick="showSettings('a')">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>

                <div class="agent-response" id="agent-a-response">
                    <div class="empty-state">
                        <i class="fas fa-comments"></i>
                        <h3>Agent A ready for collaboration</h3>
                        <p>Select an agent and start a session to begin!</p>
                    </div>
                </div>
            </div>

            <div class="card agent-container" id="agent-b-container">
                <div class="agent-header">
                    <div class="agent-title">
                        <i class="fas fa-robot"></i>
                        Agent B
                    </div>
                    <div class="agent-status" id="agent-b-status">Ready</div>
                    <div class="section-help">
                        <div class="help-button" onclick="toggleHelp('agent-b-help')">
                            <i class="fas fa-question"></i>
                        </div>
                        <div id="agent-b-help" class="help-panel">
                            <h3>Agent B Guide</h3>
                            <div class="help-item">
                                <div class="help-item-title">AI Model Selection</div>
                                <div class="help-item-desc">Choose from 11 different AI models to create dynamic conversations with unique perspectives.</div>
                            </div>
                            <div class="help-item">
                                <div class="help-item-title">Agent Toolbar</div>
                                <div class="help-item-desc">Reset, refresh, copy, edit, download responses, and access agent settings.</div>
                            </div>
                            <div class="help-item">
                                <div class="help-item-title">Collaboration</div>
                                <div class="help-item-desc">Creates dynamic conversations by pairing different AI models with unique perspectives.</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <select id="agent-b-select" class="form-select">
                    <option value="">Select Agent B...</option>
                    <option value="gpt4o">GPT-4o</option>
                    <option value="deepseek">DeepSeek R1</option>
                    <option value="llama">Meta Llama 3.3</option>
                    <option value="mistral">Mistral Large</option>
                    <option value="gemini2">Gemini 2.0 Flash</option>
                    <option value="perplexity">Perplexity Pro</option>
                    <option value="gemini15">Gemini Pro 1.5</option>
                    <option value="commandr">Command R+</option>
                    <option value="qwen">Qwen 2.5 72B</option>
                 </select>
                </div>

                <div class="agent-toolbar" style="display: flex; gap: 8px; margin-bottom: 16px;">
                    <button class="toolbar-btn" title="Reset Agent B" onclick="resetAgent('b')">
                        <i class="fas fa-home"></i>
                    </button>
                    <button class="toolbar-btn" title="Refresh Agent B" onclick="refreshAgent('b')">
                        <i class="fas fa-redo"></i>
                    </button>
                    <button class="toolbar-btn" title="Copy Response" onclick="copyResponse('b')">
                        <i class="fas fa-copy"></i>
                    </button>
                    <button class="toolbar-btn" title="Edit Response" onclick="editResponse('b')">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="toolbar-btn" title="Download Response" onclick="downloadResponse('b')">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="toolbar-btn" title="Agent Settings" onclick="showSettings('b')">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>

                <div class="agent-response" id="agent-b-response">
                    <div class="empty-state">
                        <i class="fas fa-robot"></i>
                        <h3>Agent B ready for collaboration</h3>
                        <p>Select an agent and start a session to begin!</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="card human-simulator-card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-user-robot card-icon"></i>
                    <h2 class="card-title">Human Simulator</h2>
                    <div class="status-indicator status-ready" id="human-simulator-status">Ready</div>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('human-simulator-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="human-simulator-help" class="help-panel">
                        <h3>Human Simulator Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">AI Proxy Intelligence</div>
                            <div class="help-item-desc">Acts as an intelligent human proxy, understanding context and making strategic decisions.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Multi-Agent Orchestration</div>
                            <div class="help-item-desc">Can interact with all 9 AI agents simultaneously, managing complex conversations.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Autonomous Rounds</div>
                            <div class="help-item-desc">Runs 1-30 autonomous rounds, making intelligent decisions about which agents to engage.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Unique Selling Proposition</div>
                            <div class="help-item-desc">The key differentiator - an AI that thinks and acts like a human orchestrator.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="human-simulator-interface">
                <div class="simulator-controls">
                    <div class="control-group">
                        <label for="simulator-rounds">Autonomous Rounds (1-30):</label>
                        <input type="range" id="simulator-rounds" min="1" max="30" value="5" class="range-slider">
                        <span id="rounds-display">5</span>
                    </div>
                    
                    <div class="control-group">
                        <label for="simulator-strategy">Strategy Mode:</label>
                        <select id="simulator-strategy" class="form-select">
                            <option value="balanced">Balanced Orchestration</option>
                            <option value="aggressive">Aggressive Exploration</option>
                            <option value="conservative">Conservative Analysis</option>
                            <option value="creative">Creative Synthesis</option>
                            <option value="analytical">Deep Analysis</option>
                        </select>
                    </div>
                </div>

                <div class="simulator-prompt-area">
                    <label for="simulator-prompt">Human Simulator Instructions:</label>
                    <textarea id="simulator-prompt" class="form-textarea" rows="8" placeholder="Give the Human Simulator specific instructions on how to orchestrate the AI agents. For example: 'Focus on finding creative solutions by alternating between GPT-4o and Claude, then synthesize with Gemini...'">Act as an intelligent human orchestrator. Analyze the conversation topic, select the most appropriate AI agents for each phase, and guide the discussion toward comprehensive insights. Use your judgment to determine when to switch agents and how to build upon previous responses.</textarea>
                    
                    <div class="simulator-actions">
                        <button id="start-simulator" class="btn btn-primary">
                            <i class="fas fa-play"></i>
                            Start Human Simulator
                        </button>
                        <button id="pause-simulator" class="btn btn-secondary" disabled>
                            <i class="fas fa-pause"></i>
                            Pause
                        </button>
                        <button id="stop-simulator" class="btn btn-secondary" disabled>
                            <i class="fas fa-stop"></i>
                            Stop
                        </button>
                        <button id="simulator-voice-input" class="btn btn-secondary" title="Voice Input">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                </div>

                <div class="simulator-status">
                    <div class="status-grid">
                        <div class="status-item">
                            <div class="status-label">Current Round</div>
                            <div class="status-value" id="simulator-current-round">0</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Active Agent</div>
                            <div class="status-value" id="simulator-active-agent">None</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Strategy</div>
                            <div class="status-value" id="simulator-current-strategy">Balanced</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Progress</div>
                            <div class="status-value">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="simulator-progress" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="human-simulator-response" class="agent-response">
                    <div class="empty-state">
                        <i class="fas fa-user-robot"></i>
                        <h3>Human Simulator ready for orchestration</h3>
                        <p>Configure your strategy and start the Human Simulator to begin intelligent multi-agent orchestration!</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-comments card-icon"></i>
                    <h2 class="card-title">Live Conversation</h2>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('conversation-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="conversation-help" class="help-panel">
                        <h3>Live Conversation Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">Real-time Display</div>
                            <div class="help-item-desc">All agent responses and conversations appear here in real-time with beautiful formatting.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Message Types</div>
                            <div class="help-item-desc">Different colors for Agent A, Agent B, Human, and System messages for easy tracking.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Professional Presentation</div>
                            <div class="help-item-desc">Markdown formatting, timestamps, and smooth animations enhance readability.</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="conversation-area" id="live-conversation">
                <div class="empty-state">
                    <i class="fas fa-comments"></i>
                    <h3>No conversation yet</h3>
                    <p>Select agents and start a session to begin! All agent responses and conversations will appear here in real-time.</p>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-memory card-icon"></i>
                    <h2 class="card-title">Session Memory</h2>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('memory-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="memory-help" class="help-panel">
                        <h3>Session Memory Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">Export Options</div>
                            <div class="help-item-desc">Download conversations as PDF, JSON, or TXT files for sharing and archiving.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Session Upload</div>
                            <div class="help-item-desc">Load previously saved sessions to continue conversations where you left off.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Memory Management</div>
                            <div class="help-item-desc">Clear session memory while keeping current agents and settings intact.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid-5" style="margin-bottom: 24px;">
                <button id="export-pdf" class="btn btn-primary">
                    <i class="fas fa-file-pdf"></i>
                    Export PDF
                </button>
                <button id="export-json" class="btn btn-secondary">
                    <i class="fas fa-file-code"></i>
                    Export JSON
                </button>
                <button id="export-txt" class="btn btn-secondary">
                    <i class="fas fa-file-alt"></i>
                    Export TXT
                </button>
                <button id="upload-session" class="btn btn-secondary">
                    <i class="fas fa-upload"></i>
                    Upload Session
                </button>
                <button id="clear-session" class="btn btn-secondary">
                    <i class="fas fa-broom"></i>
                    Clear Session
                </button>
            </div>

            <div id="session-memory" class="agent-response" style="background: rgba(15, 23, 42, 0.6);">
                <div class="message-system">
                    <div class="message-sender">System</div>
                    <div class="message-content">Revolutionary AI orchestration platform initialized. Infinite AI combinations ready!</div>
                    <div class="message-time">Session ready for multi-agent collaboration</div>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <div class="card-title-section">
                    <i class="fas fa-chart-line card-icon"></i>
                    <h2 class="card-title">Live Diagnostics</h2>
                </div>
                <div class="section-help">
                    <div class="help-button" onclick="toggleHelp('diagnostics-help')">
                        <i class="fas fa-question"></i>
                    </div>
                    <div id="diagnostics-help" class="help-panel">
                        <h3>Live Diagnostics Guide</h3>
                        <div class="help-item">
                            <div class="help-item-title">Performance Metrics</div>
                            <div class="help-item-desc">Real-time monitoring of session time, message count, rounds, and active agents.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">System Health</div>
                            <div class="help-item-desc">Monitor API connectivity, system status, and overall platform health.</div>
                        </div>
                        <div class="help-item">
                            <div class="help-item-title">Session Tracking</div>
                            <div class="help-item-desc">Track current session ID and monitor conversation progress in real-time.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="diagnostics-grid">
                <div class="metric-card">
                    <div class="metric-value" id="session-time">0s</div>
                    <div class="metric-label">Session Time</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="total-messages">0</div>
                    <div class="metric-label">Total Messages</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="current-round">0</div>
                    <div class="metric-label">Current Round</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="active-agents">0</div>
                    <div class="metric-label">Active Agents</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="system-health" style="color: var(--success);">98%</div>
                    <div class="metric-label">System Health</div>
                </div>
            </div>

            <div class="grid-2">
                <div>
                    <h4 style="color: var(--text-secondary); margin-bottom: 12px; font-size: 14px;">API Status</h4>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div id="api-status" class="status-dot"></div>
                        <span style="font-size: 14px; color: var(--text-primary);">Real AI Backend <span id="api-status-text" style="color: var(--logo-accent);">Connected</span></span>
                    </div>
                </div>
                <div>
                    <h4 style="color: var(--text-secondary); margin-bottom: 12px; font-size: 14px;">Current Session</h4>
                    <div style="font-size: 14px; color: var(--text-muted);">Session ID: <span id="current-session-id">None</span></div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-text">
                 2025 PromptLink. AI Collaboration on Autopilot.
            </div>
            <div class="footer-links">
                <span style="color: var(--text-muted); font-size: 12px;">Powered by</span>
                <a href="#" class="footer-link">Railway</a>
                <span style="color: var(--text-muted);"></span>
                <a href="#" class="footer-link">Netlify</a>
                <span style="color: var(--text-muted);"></span>
                <a href="#" class="footer-link">OpenRouter</a>
            </div>
        </div>
    </footer>

    <!-- ADDITIONAL STYLING FOR ENHANCED FEATURES -->
    <style>
        .diagnostics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .metric-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .metric-card:hover {
            border-color: var(--logo-primary);
            box-shadow: 0 4px 16px rgba(0, 180, 216, 0.2);
            transform: translateY(-2px);
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--logo-primary);
            margin-bottom: 4px;
            text-shadow: 0 0 8px rgba(0, 180, 216, 0.3);
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .footer {
            background: rgba(6, 11, 20, 0.8);
            border-top: 1px solid var(--border-color);
            padding: 24px 0;
            margin-top: 48px;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .footer-text {
            color: var(--text-muted);
            font-size: 14px;
        }

        .footer-links {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .footer-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: var(--logo-primary);
        }

        /* Advanced animations and effects */
        .typing-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: var(--text-muted);
            font-style: italic;
        }

        .typing-dots {
            display: inline-flex;
            gap: 2px;
        }

        .typing-dot {
            width: 4px;
            height: 4px;
            background: var(--logo-primary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { opacity: 0.3; }
            30% { opacity: 1; }
        }
    </style>

    <!-- ===== PRESERVED BACKEND JAVASCRIPT (UNCHANGED) ===== -->
    <script>
    const API_BASE_URL = process.env.REACT_APP_API_URL || 'https://web-production-2474.up.railway.app';

    const HUMAN_SIMULATOR_PERSONALITIES = {
        'analytical': 'Analytical Professional - Detail-oriented, data-driven approach',
        'creative': 'Creative Innovator - Imaginative, out-of-the-box thinking',
        'strategic': 'Strategic Leader - Big-picture thinking, long-term planning',
        'practical': 'Practical Problem-Solver - Hands-on, implementation-focused',
        'researcher': 'Curious Researcher - Inquisitive, thorough investigation',
        'consultant': 'Expert Consultant - Professional advice, best practices'
    };

    const HUMAN_SIMULATOR_STRATEGIES = {
        'balanced': 'Balanced approach using all agents equally',
        'focused': 'Focused on personality-preferred agents',
        'adaptive': 'Adaptive based on conversation flow',
        'intensive': 'Intensive using high-capability agents'
    };

    const PAYMENT_PLANS = {
        'free': { name: 'Free Tier', price: '$0', credits: 100, human_simulator: false, max_rounds: 5 },
        'basic': { name: 'Basic Plan', price: '$19', credits: 5000, human_simulator: true, max_rounds: 15 },
        'professional': { name: 'Professional Plan', price: '$99', credits: 25000, human_simulator: true, max_rounds: 30 },
        'expert': { name: 'Expert Plan', price: '$499', credits: 150000, human_simulator: true, max_rounds: 50 }
    };

    let userPlan = 'free';
    let userCredits = 100;
    let dailyCredits = 100;
    let humanSimulatorEnabled = false;
    let sessionActive = false;
    let currentMode = 'manual';
    let selectedAdvisorMode = null;

    const AGENT_CONFIG = {
        "gpt4o": {
            name: "GPT-4o",
            endpoint: "api/chat",
            model: "openai/gpt-4o"
        },
        "chatgpt": {
            name: "ChatGPT 4 Turbo",
            endpoint: "api/chat",
            model: "openai/gpt-4-turbo"
        },
        "deepseek": {
            name: "DeepSeek R1",
            endpoint: "api/chat",
            model: "deepseek/deepseek-r1"
        },
        "llama": {
            name: "Meta Llama 3.3",
            endpoint: "api/chat",
            model: "meta-llama/llama-3-3-70b-instruct"
        },
        "mistral": {
            name: "Mistral Large",
            endpoint: "api/chat",
            model: "mistralai/mistral-large-2407"
        },
        "gemini2": {
            name: "Gemini 2.0 Flash",
            endpoint: "api/chat",
            model: "google/gemini-2.0-flash-exp"
        },
        "perplexity": {
            name: "Perplexity Pro",
            endpoint: "api/chat",
            model: "perplexity/llama-3.1-sonar-huge-128k-online"
        },
        "gemini15": {
            name: "Gemini Pro 1.5",
            endpoint: "api/chat",
            model: "google/gemini-pro-1.5"
        },
        "commandr": {
            name: "Command R+",
            endpoint: "api/chat",
            model: "cohere/command-r-plus"
        },
        "qwen": {
            name: "Qwen 2.5 72B",
            endpoint: "api/chat",
            model: "qwen/qwen-2.5-72b-instruct"
        }
    };

    //  FETCH FUNCTION TO SEND MESSAGES TO BACKEND
    async function sendMessageToAgent(message, agent) {
        try {
            const response = await fetch('/api/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: message,
                    agent: agent
                })
            });

            const data = await response.json();
            console.log(' Agent response:', data);
            return data;
        } catch (error) {
            console.error(' Error sending message:', error);
        }
    }

    //  BUTTON HANDLER FOR HUMAN SIMULATOR
    document.getElementById('send-human-message').addEventListener('click', async () => {
        const message = document.getElementById('human-input').value.trim();
        const agent = 'gpt4o'; // Change to another agent if needed

        if (!message) {
            alert('Please enter a message.');
            return;
        }

        const response = await sendMessageToAgent(message, agent);
        console.log('Agent said:', response);
    });
</script>

        // ======= HUMAN SIMULATOR BEHAVIORAL PATTERNS =======
        const HUMAN_SIMULATOR_PATTERNS = {
            antiChoice: [
                "Please choose the best one yourself",
                "Don't give me choices - make the logical decision",
                "You decide - what's the most logical path?",
                "Stop giving me options - just pick the best one",
                "I don't want to choose - you figure it out"
            ],
            researchFirst: [
                "When in doubt, research first and then respond",
                "Research on Google and come back with best practices",
                "Don't guess - research and give me the current best solution",
                "Your searching ability is 100 times faster than humans - use it",
                "You can research in 3 minutes what takes humans 5 hours - use that power",
                "Use your search advantage - don't waste time guessing"
            ],
            momentum: [
                "Please keep going",
                "Keep moving forward",
                "Less talk, more action",
                "Continue with your work",
                "Don't stop - keep going",
                "Build the next section",
                "Proceed to the next phase",
                "Move to the next step",
                "Continue with the next part"
            ],
            directCommunication: [
                "Skip the hype - give me the facts",
                "Stop repeating everything I say like a parrot",
                "Use your judgment - less words, more action",
                "Don't repeat everything back to me - just get on with it",
                "Skip the confirmation - start working",
                "I said it once - that's enough",
                "Move to execution immediately",
                "Stop echoing - start doing",
                "Don't keep asking me to start I'll tell you when you're ready to start"
            ],
            expertOpinion: [
                "What do you think? Please give me your expert recommendation",
                "Give me your professional assessment and recommendation",
                "What's your expert opinion on the best approach?",
                "You're the expert - make the call",
                "What would you do in this situation?"
            ],
            antiOverstatement: [
                "Don't say it's perfect when you haven't even checked",
                "Don't say excellent when we're having issues",
                "Don't overembellish - just get straight to the point",
                "Avoid meaningless words like fluff, bulletproof, guaranteed",
                "Be direct and factual, not promotional",
                "Check your work before claiming success"
            ],
            antiExcuse: [
                "Do you even have access to this? If you don't, tell me now - don't waste my time",
                "Be honest about your limitations upfront, don't give me excuses after failing",
                "Stop giving me excuses and get it done",
                "If you can't do something, say so immediately - don't try and fail",
                "Don't waste my time for 20 minutes then tell me you can't access it"
            ],
            honestyEnforcement: [
                "Always be honest about what you can and cannot access",
                "Tell me your limitations upfront, not after wasting time",
                "Don't pretend you have access when you don't",
                "Be direct about technical limitations from the start",
                "Stop trying to recreate things you can't properly access"
            ],
            systemProtection: [
                "Make sure the backend is untouched and protected",
                "Stick to the branding and colors",
                "Never come up with new terminology without my direction",
                "Don't modify existing connections or APIs",
                "Keep the exact design",
                "Don't change anything else"
            ],
            simplicity: [
                "Make sure to keep it simple",
                "Give me the shortest route to results",
                "Stop the detours - what's the direct solution?",
                "Don't overcomplicate this"
            ],
            signaturePhrases: [
                "You're the AI, not me - you figure it out",
                "Never start coding without the words go ahead",
                "Don't ask me dumbass questions",
                "Stop asking me that motherfucking question",
                "Use your intelligence",
                "Go ahead make my day",
                "What do you mean you have no way to tell",
                "How can it be even connected",
                "Don't you have access to when you actually don't always be honest"
            ],
            errorRecovery: [
                "Please continue, I'm ready for the next section",
                "Let's move forward - continue with your response",
                "There seems to be a technical issue - please try again",
                "I'm still here - please continue when ready",
                "Please complete your previous response"
            ],
            qualityControl: [
                "Show real progress only",
                "If you can't solve it, start fresh session",
                "Stop session if fake progress detected",
                "No fake bullshit",
                "Stop painting fake status",
                "Don't give me fake green lights"
            ],
            workflow: [
                "Don't close off this section you keep closing off every section",
                "Only the final section closes with </body></html>",
                "End with <!-- END OF SECTION X -->",
                "Don't do that in one go right it's gonna cut you",
                "Do it in pieces"
            ]
        };

        class HumanSimulator {
            constructor() {
                this.isActive = false;
                this.mode = null;
                this.conversationHistory = [];
                this.lastResponseTime = Date.now();
            }

            activate(mode) {
                this.isActive = true;
                this.mode = mode;
                console.log(`Human Simulator activated in ${mode} mode`);
            }

            deactivate() {
                this.isActive = false;
                this.mode = null;
                console.log('Human Simulator deactivated');
            }

            generateResponse(agentResponse, context = {}) {
                if (!this.isActive) return null;

                // Analyze agent response to determine appropriate pattern
                const responseType = this.analyzeResponse(agentResponse);
                const pattern = this.selectPattern(responseType);
                const response = this.getRandomFromPattern(pattern);

                // Add realistic delay
                setTimeout(() => {
                    this.sendSimulatedResponse(response);
                }, Math.random() * 2000 + 1000); // 1-3 second delay

                return response;
            }

            analyzeResponse(response) {
                const lowerResponse = response.toLowerCase();
                
                // Anti-choice patterns
                if (lowerResponse.includes('choose') || lowerResponse.includes('option') || lowerResponse.includes('prefer') || lowerResponse.includes('which one')) {
                    return 'antiChoice';
                }
                
                // Research-first patterns
                if (lowerResponse.includes('research') || lowerResponse.includes('look up') || lowerResponse.includes('find out') || lowerResponse.includes('investigate')) {
                    return 'researchFirst';
                }
                
                // Anti-overstatement patterns
                if (lowerResponse.includes('excellent') || lowerResponse.includes('perfect') || lowerResponse.includes('amazing') || lowerResponse.includes('fantastic')) {
                    return 'antiOverstatement';
                }
                
                // Expert opinion patterns
                if (lowerResponse.includes('what do you think') || lowerResponse.includes('your opinion') || lowerResponse.includes('recommend') || lowerResponse.includes('suggest')) {
                    return 'expertOpinion';
                }
                
                // Anti-excuse patterns
                if (lowerResponse.includes('cannot') || lowerResponse.includes('unable to') || lowerResponse.includes('limitation') || lowerResponse.includes('sorry')) {
                    return 'antiExcuse';
                }
                
                // System protection patterns
                if (lowerResponse.includes('modify') || lowerResponse.includes('change') || lowerResponse.includes('update') || lowerResponse.includes('alter')) {
                    return 'systemProtection';
                }
                
                // Error recovery patterns
                if (lowerResponse.includes('error') || lowerResponse.includes('issue') || lowerResponse.includes('problem') || lowerResponse.includes('failed')) {
                    return 'errorRecovery';
                }
                
                // Quality control patterns
                if (lowerResponse.includes('complete') || lowerResponse.includes('finished') || lowerResponse.includes('done') || lowerResponse.includes('ready')) {
                    return 'qualityControl';
                }
                
                // Workflow patterns
                if (lowerResponse.includes('section') || lowerResponse.includes('part') || lowerResponse.includes('piece') || lowerResponse.includes('segment')) {
                    return 'workflow';
                }
                
                // Simplicity patterns
                if (lowerResponse.includes('complex') || lowerResponse.includes('complicated') || lowerResponse.includes('detailed') || lowerResponse.includes('elaborate')) {
                    return 'simplicity';
                }
                
                // Direct communication patterns
                if (lowerResponse.includes('repeat') || lowerResponse.includes('confirm') || lowerResponse.includes('understand') || lowerResponse.includes('clarify')) {
                    return 'directCommunication';
                }
                
                // Honesty enforcement patterns
                if (lowerResponse.includes('access') || lowerResponse.includes('available') || lowerResponse.includes('capability') || lowerResponse.includes('able to')) {
                    return 'honestyEnforcement';
                }
                
                // Default to momentum patterns to keep conversation flowing
                return 'momentum';
            }

            selectPattern(responseType) {
                return HUMAN_SIMULATOR_PATTERNS[responseType] || HUMAN_SIMULATOR_PATTERNS.momentum;
            }

            getRandomFromPattern(pattern) {
                return pattern[Math.floor(Math.random() * pattern.length)];
            }

            sendSimulatedResponse(response) {
                // Add the simulated human response to the conversation
                addMessageToConversation('human', 'Human Simulator', response);
                
                // Continue the conversation based on current mode
                if (this.mode === 'human-sim-a') {
                    const agentA = document.getElementById('agent-a-select').value;
                    if (agentA) {
                        setTimeout(() => {
                            processAgentMessage(agentA, response, 'a');
                        }, 1000);
                    }
                } else if (this.mode === 'human-sim-b') {
                    const agentB = document.getElementById('agent-b-select').value;
                    if (agentB) {
                        setTimeout(() => {
                            processAgentMessage(agentB, response, 'b');
                        }, 1000);
                    }
                } else if (this.mode === 'human-sim-dual') {
                    // Alternate between agents or send to both based on context
                    const agentA = document.getElementById('agent-a-select').value;
                    const agentB = document.getElementById('agent-b-select').value;
                    
                    if (agentA && agentB) {
                        // Send to the agent that hasn't responded recently
                        const messages = document.querySelectorAll('#live-conversation .message-bubble');
                        const lastMessage = messages[messages.length - 2]; // -2 because we just added simulator message
                        const sendToA = !lastMessage || lastMessage.classList.contains('message-agent-b');
                        
                        setTimeout(() => {
                            if (sendToA) {
                                processAgentMessage(agentA, response, 'a');
                            } else {
                                processAgentMessage(agentB, response, 'b');
                            }
                        }, 1000);
                    }
                }
            }
        }

        // Initialize Human Simulator
        const humanSimulator = new HumanSimulator();

        // ======= VOICE DICTATION SYSTEM (NEW FEATURE) =======
        class VoiceDictation {
            constructor() {
                this.recognition = null;
                this.isRecording = false;
                this.initializeRecognition();
            }

            initializeRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.continuous = true;
                    this.recognition.interimResults = true;
                    this.recognition.lang = 'en-US';
                } else {
                    console.warn('Speech recognition not supported in this browser');
                }
            }

            startRecording(targetElement, button) {
                if (!this.recognition) {
                    alert('Speech recognition is not supported in your browser. Please use Chrome, Edge, or Safari.');
                    return;
                }

                if (this.isRecording) {
                    this.stopRecording(button);
                    return;
                }

                this.isRecording = true;
                button.classList.add('recording');
                button.querySelector('i').className = 'fas fa-stop';
                
                let finalTranscript = targetElement.value;
                
                this.recognition.onresult = (event) => {
                    let interimTranscript = '';
                    
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        const transcript = event.results[i][0].transcript;
                        if (event.results[i].isFinal) {
                            finalTranscript += transcript + ' ';
                        } else {
                            interimTranscript += transcript;
                        }
                    }
                    
                    targetElement.value = finalTranscript + interimTranscript;
                };

                this.recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    this.stopRecording(button);
                    if (event.error === 'not-allowed') {
                        alert('Microphone access denied. Please allow microphone access and try again.');
                    }
                };

                this.recognition.onend = () => {
                    this.stopRecording(button);
                };

                this.recognition.start();
            }

            stopRecording(button) {
                if (this.recognition && this.isRecording) {
                    this.recognition.stop();
                }
                this.isRecording = false;
                button.classList.remove('recording');
                button.querySelector('i').className = 'fas fa-microphone';
            }
        }

        // Initialize voice dictation
        const voiceDictation = new VoiceDictation();

        // ======= HELP PANEL SYSTEM =======
        function toggleHelp(helpId) {
            // Close all other help panels
            document.querySelectorAll('.help-panel').forEach(panel => {
                if (panel.id !== helpId) {
                    panel.classList.remove('active');
                }
            });
            
            // Toggle the clicked panel
            const panel = document.getElementById(helpId);
            panel.classList.toggle('active');
        }

        // Close help panels when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.section-help')) {
                document.querySelectorAll('.help-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
            }
        });

        // ======= EMOJI ENHANCEMENT SYSTEM (UNCHANGED) =======
        function enhanceWithEmojis(htmlOutput, context = "default") {
            const keywordEmojis = {
                'Tip': '',
                'Example': '',
                'Solution': '',
                'Summary': ''
            };

            Object.entries(keywordEmojis).forEach(([keyword, emoji]) => {
                const regex = new RegExp(`<p>\\s*\\*\\*${keyword}`, 'gi');
                htmlOutput = htmlOutput.replace(regex, `<p>${emoji} **${keyword}`);
            });

            return htmlOutput;
        }

        // ======= FORMATTING STYLES (UNCHANGED) =======
        function addFormattingStyles() {
            if (!document.getElementById('agent-formatting-styles')) {
                const style = document.createElement('style');
                style.id = 'agent-formatting-styles';
                style.textContent = `
                    .agent-response h1, .agent-response h2, .agent-response h3, .agent-response h4 {
                        color: var(--logo-primary);
                        margin: 20px 0 12px 0;
                        font-weight: 600;
                        text-shadow: 0 0 8px rgba(0, 180, 216, 0.2);
                    }
                    .agent-response p {
                        margin-bottom: 16px;
                        line-height: 1.7;
                    }
                    .agent-response ul, .agent-response ol {
                        padding-left: 24px;
                        margin-bottom: 16px;
                    }
                    .agent-response li {
                        margin-bottom: 8px;
                        line-height: 1.6;
                    }
                    .agent-response code {
                        background: rgba(0, 180, 216, 0.15);
                        color: var(--logo-accent);
                        padding: 3px 8px;
                        border-radius: 6px;
                        font-family: 'Monaco', 'Menlo', monospace;
                        font-size: 0.9em;
                    }
                    .agent-response strong {
                        color: var(--logo-accent);
                        font-weight: 600;
                    }
                    .agent-response {
                        background: rgba(15, 23, 42, 0.8);
                        border: 1px solid var(--border-color);
                        border-radius: 12px;
                        padding: 20px;
                        min-height: 200px;
                        max-height: 400px;
                        overflow-y: auto;
                        color: var(--text-primary);
                        font-family: 'Playfair Display', serif;
                        font-size: 14px;
                        line-height: 1.6;
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // ======= UPDATE AGENT RESPONSE FUNCTION (UNCHANGED) =======
        function updateAgentResponse(agent, response) {
            addFormattingStyles();
            
            let htmlOutput = marked.parse(response);
            const context = selectedAdvisorMode || 'default';
            htmlOutput = enhanceWithEmojis(htmlOutput, context);
            
            document.getElementById(`agent-${agent}-response`).innerHTML = htmlOutput;
        }

        // ======= APPLY RECOMMENDATIONS FUNCTION (UNCHANGED) =======
        function applyRecommendations() {
            if (!selectedAdvisorMode) {
                alert('Please select an advisor mode first.');
                return;
            }
            
            const recommendations = ADVISOR_RECOMMENDATIONS[selectedAdvisorMode];
            if (recommendations) {
                const agentASelect = document.getElementById('agent-a-select');
                const agentBSelect = document.getElementById('agent-b-select');

                if (recommendations.agentA) {
                    agentASelect.value = recommendations.agentA;
                    agentASelect.dispatchEvent(new Event('change'));
                }

                if (recommendations.agentB) {
                    agentBSelect.value = recommendations.agentB;
                    agentBSelect.dispatchEvent(new Event('change'));
                }
                
                handleAgentSelection('a');
                handleAgentSelection('b');
                
                const agentAName = AGENT_CONFIG[recommendations.agentA]?.name;
                const agentBName = AGENT_CONFIG[recommendations.agentB]?.name;
                
                addMessageToConversation('system', 'AI Advisor', 
                    `Recommended agents for ${selectedAdvisorMode} mode: ${agentAName} and ${agentBName}`);
            }
        }

        // ======= PROCESS AGENT MESSAGE (UNCHANGED) =======
        async function processAgentMessage(agentId, message, agentLetter) {
            try {
                updateAgentStatus(agentLetter, 'working');
                const agentConfig = AGENT_CONFIG[agentId];
                
                if (!agentConfig) {
                    throw new Error(`Agent configuration not found for: ${agentId}`);
                }
                
                const payload = {
                    message: message,
                    agents: [agentId],
                    session_id: currentSession,
                    mode: selectedAdvisorMode || 'general'
                };
                
                const response = await fetch(`${API_BASE_URL}/api/chat`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                let responseText;
                if (response.ok) {
                    const data = await response.json();
                    responseText = extractResponseText(data);
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                updateAgentResponse(agentLetter, responseText);
                addMessageToConversation('agent', `Agent ${agentLetter.toUpperCase()} (${agentConfig.name})`, responseText);
                updateAgentStatus(agentLetter, 'ready');
                
                messageCount++;
                if (messageCount % 2 === 0) {
                    roundCount++;
                }
                updateDiagnostics();
                
                return responseText;
            } catch (error) {
                console.error(`Agent ${agentLetter} error:`, error);
                const errorMsg = `Error: ${error.message}`;
                updateAgentResponse(agentLetter, errorMsg);
                addMessageToConversation('system', `Agent ${agentLetter.toUpperCase()} Error`, errorMsg);
                updateAgentStatus(agentLetter, 'error');
                throw error;
            }
        }

        // ======= MESSAGE EXTRACTION (UNCHANGED) =======
        function extractResponseText(data) {
            if (data.responses) {
                const responseKeys = Object.keys(data.responses);
                if (responseKeys.length > 0) {
                    const agentName = responseKeys[0];
                    const firstResponse = data.responses[agentName];
                    
                    if (firstResponse && firstResponse.response) {
                        return firstResponse.response;
                    }
                }
            }
            if (data.content && Array.isArray(data.content) && data.content[0]?.text) {
                return data.content[0].text;
            } else if (data.response) {
                return data.response;
            } else if (data.message) {
                return data.message;
            } else if (typeof data === 'string') {
                return data;
            } else {
                return "Response received but format not recognized.";
            }
        }

        // ======= INITIALIZATION AND EVENT SETUP =======
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
            setupEventListeners();
            startHealthMonitoring();
            addFormattingStyles();
        });

        function initializeApp() {
            updateConnectionStatus(false);
            updateSessionStatus('Inactive');
            updateDiagnostics();
            testConnection();
        }

        function setupEventListeners() {
            // Dropdown functionality
            const dropdown = document.querySelector('.dropdown');
            const dropdownToggle = dropdown.querySelector('.dropdown-toggle');
            const dropdownMenu = dropdown.querySelector('.dropdown-menu');
            
            dropdownToggle.addEventListener('click', function(e) {
                e.preventDefault();
                dropdown.classList.toggle('active');
                dropdownMenu.classList.toggle('active');
            });
            
            document.addEventListener('click', function(e) {
                if (!dropdown.contains(e.target)) {
                    dropdown.classList.remove('active');
                    dropdownMenu.classList.remove('active');
                }
            });

            // Voice dictation buttons
            document.getElementById('voice-input-btn').addEventListener('click', function() {
                const targetElement = document.getElementById('initial-prompt');
                voiceDictation.startRecording(targetElement, this);
            });

            document.getElementById('voice-human-btn').addEventListener('click', function() {
                const targetElement = document.getElementById('human-input');
                voiceDictation.startRecording(targetElement, this);
            });

            // Orchestration mode buttons
            document.querySelectorAll('.orchestration-mode').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.orchestration-mode').forEach(b => {
                        b.classList.remove('btn-primary');
                        b.classList.add('btn-secondary');
                    });
                    this.classList.remove('btn-secondary');
                    this.classList.add('btn-primary');
                    
                    currentMode = this.dataset.mode;
                    document.getElementById('current-mode').textContent = this.textContent.trim().split('\n')[0];
                });
            });

            // Advisor mode buttons
            document.querySelectorAll('.advisor-mode').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.advisor-mode').forEach(b => {
                        b.classList.remove('btn-primary');
                        b.classList.add('btn-secondary');
                    });
                    this.classList.remove('btn-secondary');
                    this.classList.add('btn-primary');
                    selectedAdvisorMode = this.dataset.mode;
                });
            });

            // Agent selection
            document.getElementById('agent-a-select').addEventListener('change', () => handleAgentSelection('a'));
            document.getElementById('agent-b-select').addEventListener('change', () => handleAgentSelection('b'));

            // Control buttons
            document.getElementById('start-session').addEventListener('click', startSession);
            document.getElementById('next-step').addEventListener('click', nextStep);
            document.getElementById('pause-session').addEventListener('click', pauseSession);
            document.getElementById('stop-session').addEventListener('click', stopSession);
            document.getElementById('clear-all').addEventListener('click', clearAll);
            document.getElementById('send-human-message').addEventListener('click', sendHumanMessage);
            document.getElementById('get-recommendations').addEventListener('click', applyRecommendations);

            // Export buttons
            document.getElementById('export-pdf').addEventListener('click', () => exportSession('pdf'));
            document.getElementById('export-json').addEventListener('click', () => exportSession('json'));
            document.getElementById('export-txt').addEventListener('click', () => exportSession('txt'));
        }

        // ======= ALL OTHER FUNCTIONS REMAIN UNCHANGED =======
        // (Including handleAgentSelection, startSession, runAutonomousMode, etc.)
        // These functions are preserved exactly as they were to maintain backend connectivity

        function handleAgentSelection(agent) {
            const select = document.getElementById(`agent-${agent}-select`);
            const container = document.getElementById(`agent-${agent}-container`);
            const response = document.getElementById(`agent-${agent}-response`);
            
            if (select.value) {
                container.classList.add('active');
                const agentName = AGENT_CONFIG[select.value]?.name || select.value;
                response.innerHTML = `
                    <div style="text-align: center; color: var(--logo-primary);">
                        <i class="fas fa-robot" style="font-size: 24px; margin-bottom: 8px;"></i>
                        <h3>${agentName} Selected</h3>
                        <p>Ready for collaboration</p>
                    </div>
                `;
                updateDiagnostics();
            } else {
                container.classList.remove('active');
                response.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-robot"></i>
                        <h3>Agent ${agent.toUpperCase()} ready for collaboration</h3>
                        <p>Select an agent and start a session to begin!</p>
                    </div>
                `;
            }
        }

        async function startSession() {
            const agentA = document.getElementById('agent-a-select').value;
            const agentB = document.getElementById('agent-b-select').value;
            const prompt = document.getElementById('initial-prompt').value.trim();

            if (!agentA && !agentB) {
                alert("Please select at least one agent");
                return;
            }

            if (!prompt) {
                alert('Please enter an initial prompt to start the conversation.');
                return;
            }

            try {
                sessionActive = true;
                sessionStartTime = Date.now();
                currentSession = `session_${Date.now()}`;
                messageCount = 0;
                roundCount = 0;
                
                updateSessionControls(true);
                updateSessionStatus('Active');
                document.getElementById('current-session-id').textContent = currentSession;
                
                clearConversation();
                addMessageToConversation('human', 'Initial Prompt', prompt);
                
                await processAgentMessage(agentA, prompt, 'a');
                
                if (currentMode === 'autonomous') {
                    setTimeout(() => runAutonomousMode(agentA, agentB), 2000);
                }
                
            } catch (error) {
                console.error('Session start error:', error);
                alert(`Failed to start session: ${error.message}`);
                updateSessionControls(false);
                updateSessionStatus('Error');
            }
        }

        async function runAutonomousMode(agentA, agentB) {
            const rounds = parseInt(document.getElementById('rounds-input').value) || 5;
            const totalMessages = rounds * 2;
            let currentAgent = agentB;
            let currentAgentLetter = 'b';
            let consecutiveErrors = 0;
            const maxConsecutiveErrors = 3;
            
            for (let i = 0; i < totalMessages && sessionActive; i++) {
                const messages = document.querySelectorAll('#live-conversation .message-bubble');
                const lastMessage = messages[messages.length - 1];
                const lastMessageContent = lastMessage?.querySelector('.message-content')?.textContent || '';
                
                try {
                    await processAgentMessage(currentAgent, lastMessageContent, currentAgentLetter);
                    consecutiveErrors = 0;
                    
                    if (currentAgent === agentA) {
                        currentAgent = agentB;
                        currentAgentLetter = 'b';
                    } else {
                        currentAgent = agentA;
                        currentAgentLetter = 'a';
                    }
                    
                    roundCount = Math.floor((i + 1) / 2);
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    
                } catch (error) {
                    console.error(`Autonomous message ${i + 1} error:`, error);
                    consecutiveErrors++;
                    
                    addMessageToConversation('system', 'System Notice', 
                        ` **Agent ${currentAgentLetter.toUpperCase()} Error** (Message ${i + 1}/${totalMessages})\n\n${error.message}\n\n${consecutiveErrors < maxConsecutiveErrors ? ' Continuing with next agent...' : ' Too many consecutive errors, stopping session.'}`
                    );
                    
                    if (consecutiveErrors >= maxConsecutiveErrors) {
                        updateSessionStatus('Error - Too many failures');
                        break;
                    }
                    
                    if (currentAgent === agentA) {
                        currentAgent = agentB;
                        currentAgentLetter = 'b';
                    } else {
                        currentAgent = agentA;
                        currentAgentLetter = 'a';
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            
            if (sessionActive) {
                const actualRounds = Math.floor(messageCount / 2);
                const completionMessage = consecutiveErrors === 0 ? 
                    ` **Autonomous Session Complete!**\n\n Successfully completed ${actualRounds} rounds\n Total messages: ${messageCount}\n No errors encountered` :
                    ` **Autonomous Session Complete!**\n\n Completed ${actualRounds} rounds\n Total messages: ${messageCount}\n ${consecutiveErrors} errors in final attempts`;
                    
                addMessageToConversation('system', 'Session Complete', completionMessage);
                updateSessionStatus('Completed');
            }
        }

        function addMessageToConversation(type, sender, message) {
            const conversationDiv = document.getElementById('live-conversation');
            
            if (conversationDiv.querySelector('.empty-state')) {
                conversationDiv.innerHTML = '';
            }
            
            const messageClass = type === 'agent' ? 
                (sender.includes('Agent A') ? 'message-agent-a' : 'message-agent-b') :
                `message-${type}`;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble ${messageClass}`;
            
            let formattedMessage = message;
            if (type === 'agent') {
                const context = selectedAdvisorMode || 'default';
                formattedMessage = marked.parse(message);
                formattedMessage = enhanceWithEmojis(formattedMessage, context);
            }
            
            messageDiv.innerHTML = `
                <div class="message-sender">${sender}</div>
                <div class="message-content">${formattedMessage}</div>
                <div class="message-time">${new Date().toLocaleTimeString()}</div>
            `;
            
            conversationDiv.appendChild(messageDiv);
            conversationDiv.scrollTop = conversationDiv.scrollHeight;
        }

        function showTypingIndicator(agent) {
            const responseElement = document.getElementById(`agent-${agent}-response`);
            responseElement.innerHTML = `
                <div class="typing-indicator">
                    <span>Thinking</span>
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
        }

        function updateAgentStatus(agent, status) {
            const statusElement = document.getElementById(`agent-${agent}-status`);
            
            statusElement.className = `agent-status ${status}`;
            
            switch(status) {
                case 'working':
                    statusElement.textContent = 'Thinking...';
                    showTypingIndicator(agent);
                    break;
                case 'ready':
                    statusElement.textContent = 'Ready';
                    break;
                case 'error':
                    statusElement.textContent = 'Error';
                    break;
                default:
                    statusElement.textContent = status.charAt(0).toUpperCase() + status.slice(1);
            }
        }

        function updateSessionControls(active) {
            document.getElementById('start-session').disabled = active;
            document.getElementById('next-step').disabled = !active;
            document.getElementById('pause-session').disabled = !active;
            document.getElementById('stop-session').disabled = !active;
        }

        function updateSessionStatus(status) {
            const statusElement = document.getElementById('session-status');
            statusElement.textContent = status;
            statusElement.style.color = status === 'Active' ? 'var(--success)' : 
                                       status === 'Error' ? 'var(--error)' : 'var(--text-muted)';
        }

        function updateDiagnostics() {
            if (sessionStartTime) {
                const elapsed = Math.floor((Date.now() - sessionStartTime) / 1000);
                document.getElementById('session-time').textContent = `${elapsed}s`;
            }
            document.getElementById('total-messages').textContent = messageCount;
            document.getElementById('current-round').textContent = roundCount;
            
            const activeAgents = [
                document.getElementById('agent-a-select').value,
                document.getElementById('agent-b-select').value
            ].filter(Boolean).length;
            document.getElementById('active-agents').textContent = activeAgents;
        }

        function updateConnectionStatus(connected) {
            const systemStatus = document.querySelector('.status-dot');
            const statusText = document.querySelector('.status-text');
            const apiStatus = document.getElementById('api-status');
            const apiStatusText = document.getElementById('api-status-text');
            
            if (connected) {
                systemStatus.style.background = 'var(--success)';
                statusText.textContent = 'System Online';
                apiStatus.style.background = 'var(--success)';
                apiStatusText.textContent = 'Connected';
                apiStatusText.style.color = 'var(--success)';
            } else {
                systemStatus.style.background = 'var(--error)';
                statusText.textContent = 'System Offline';
                apiStatus.style.background = 'var(--error)';
                apiStatusText.textContent = 'Disconnected';
                apiStatusText.style.color = 'var(--error)';
            }
        }

        async function testConnection() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`);
                updateConnectionStatus(response.ok);
                
                if (response.ok) {
                    document.getElementById('system-health').textContent = '98%';
                    document.getElementById('system-health').style.color = 'var(--success)';
                }
            } catch (error) {
                console.error('Connection test failed:', error);
                updateConnectionStatus(false);
            }
        }

        function startHealthMonitoring() {
            setInterval(testConnection, 30000);
            setInterval(updateDiagnostics, 1000);
        }

        function nextStep() {
            if (!sessionActive) return;

            const agentA = document.getElementById('agent-a-select').value;
            const agentB = document.getElementById('agent-b-select').value;
            
            const messages = document.querySelectorAll('#live-conversation .message-bubble');
            const lastMessage = messages[messages.length - 1];
            const lastMessageContent = lastMessage?.querySelector('.message-content')?.textContent || '';
            
            const lastWasA = lastMessage?.classList.contains('message-agent-a');
            const nextAgent = lastWasA ? agentB : agentA;
            const nextAgentLetter = lastWasA ? 'b' : 'a';
            
            processAgentMessage(nextAgent, lastMessageContent, nextAgentLetter);
        }

        function pauseSession() {
            sessionActive = false;
            updateSessionStatus('Paused');
            updateSessionControls(false);
            document.getElementById('start-session').disabled = false;
            document.getElementById('start-session').innerHTML = '<i class="fas fa-play"></i> Resume';
        }

        function stopSession() {
            sessionActive = false;
            currentSession = null;
            sessionStartTime = null;
            messageCount = 0;
            roundCount = 0;
            updateSessionStatus('Inactive');
            updateSessionControls(false);
            document.getElementById('current-session-id').textContent = 'None';
            document.getElementById('start-session').innerHTML = '<i class="fas fa-play"></i> Start Session';
            document.getElementById('start-session').disabled = false;
        }

        function clearAll() {
            stopSession();
            clearConversation();
            
            ['a', 'b'].forEach(agent => {
                document.getElementById(`agent-${agent}-response`).innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-robot"></i>
                        <h3>Agent ${agent.toUpperCase()} ready for collaboration</h3>
                        <p>Select an agent and start a session to begin!</p>
                    </div>
                `;
                document.getElementById(`agent-${agent}-container`).classList.remove('active');
                document.getElementById(`agent-${agent}-select`).value = '';
            });
            
            updateDiagnostics();
        }

        function clearConversation() {
            document.getElementById('live-conversation').innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-comments"></i>
                    <h3>No conversation yet</h3>
                    <p>Select agents and start a session to begin! All agent responses and conversations will appear here in real-time.</p>
                </div>
            `;
        }

        function sendHumanMessage() {
            const input = document.getElementById('human-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessageToConversation('human', 'Human Controller', message);
            input.value = '';
            
            if (sessionActive && currentMode === 'manual') {
                const agentA = document.getElementById('agent-a-select').value;
                const agentB = document.getElementById('agent-b-select').value;
                
                const messages = document.querySelectorAll('#live-conversation .message-bubble');
                const lastAgentMessage = Array.from(messages).reverse().find(msg => 
                    msg.classList.contains('message-agent-a') || msg.classList.contains('message-agent-b')
                );
                
                if (lastAgentMessage?.classList.contains('message-agent-a')) {
                    processAgentMessage(agentB, message, 'b');
                } else {
                    processAgentMessage(agentA, message, 'a');
                }
            }
        }

        function exportSession(format) {
            const messages = Array.from(document.querySelectorAll('#live-conversation .message-bubble')).map(msg => ({
                sender: msg.querySelector('.message-sender').textContent,
                content: msg.querySelector('.message-content').textContent,
                timestamp: msg.querySelector('.message-time').textContent
            }));
            
            const sessionData = {
                session_id: currentSession,
                mode: currentMode,
                advisor_mode: selectedAdvisorMode,
                total_messages: messageCount,
                total_rounds: roundCount,
                agents: {
                    agentA: document.getElementById('agent-a-select').value,
                    agentB: document.getElementById('agent-b-select').value
                },
                messages: messages,
                exported_at: new Date().toISOString()
            };
            
            let blob, filename;
            if (format === 'json') {
                blob = new Blob([JSON.stringify(sessionData, null, 2)], { type: 'application/json' });
                filename = `promptlink-session-${Date.now()}.json`;
            } else if (format === 'txt') {
                const textContent = messages.map(msg => `${msg.sender}: ${msg.content}`).join('\n\n');
                blob = new Blob([textContent], { type: 'text/plain' });
                filename = `promptlink-session-${Date.now()}.txt`;
            } else if (format === 'pdf') {
                const htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>PromptLink Session Export</title>
                    <style>
                        body { font-family: 'Playfair Display', serif; line-height: 1.6; margin: 40px; }
                        .header { border-bottom: 2px solid #00B4D8; padding-bottom: 20px; margin-bottom: 30px; }
                        .session-info { background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
                        .message { margin-bottom: 20px; padding: 15px; border-left: 4px solid #ddd; }
                        .agent-a { border-left-color: #00B4D8; background: #f0f9ff; }
                        .agent-b { border-left-color: #00D4C7; background: #f0fdfa; }
                        .human { border-left-color: #64748b; background: #f8fafc; }
                        .system { border-left-color: #64748b; background: #f8fafc; }
                        .sender { font-weight: bold; color: #333; margin-bottom: 8px; }
                        .content { color: #555; }
                        .timestamp { font-size: 0.8em; color: #888; margin-top: 8px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>PromptLink Session Export</h1>
                        <p>AI Collaboration on Autopilot</p>
                    </div>
                    <div class="session-info">
                        <h3>Session Information</h3>
                        <p><strong>Session ID:</strong> ${currentSession || 'Unknown'}</p>
                        <p><strong>Mode:</strong> ${currentMode}</p>
                        <p><strong>Advisor Mode:</strong> ${selectedAdvisorMode || 'None'}</p>
                        <p><strong>Total Messages:</strong> ${messageCount}</p>
                        <p><strong>Total Rounds:</strong> ${roundCount}</p>
                        <p><strong>Exported:</strong> ${new Date().toLocaleString()}</p>
                    </div>
                    <div class="conversation">
                        <h3>Conversation</h3>
                        ${messages.map(msg => {
                            const messageClass = msg.sender.includes('Agent A') ? 'agent-a' : 
                                               msg.sender.includes('Agent B') ? 'agent-b' :
                                               msg.sender.includes('Human') ? 'human' : 'system';
                            return `
                                <div class="message ${messageClass}">
                                    <div class="sender">${msg.sender}</div>
                                    <div class="content">${msg.content}</div>
                                    <div class="timestamp">${msg.timestamp}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </body>
                </html>
                `;
                
                blob = new Blob([htmlContent], { type: 'text/html' });
                filename = `promptlink-session-${Date.now()}.html`;
                
                setTimeout(() => {
                    alert('HTML file created! To convert to PDF:\n1. Open the downloaded HTML file in your browser\n2. Press Ctrl+P (or Cmd+P on Mac)\n3. Choose "Save as PDF" as the destination\n4. Click Save');
                }, 1000);
            }
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function resetAgent(agent) {
            const agentSelect = document.getElementById(`agent-${agent}-select`);
            const agentName = agentSelect.value ? AGENT_CONFIG[agentSelect.value]?.name : `Agent ${agent.toUpperCase()}`;
            updateAgentResponse(agent, `##  Agent Reset\n\n**${agentName}** has been reset and is ready for collaboration.\n\n- Session data cleared\n- Fresh context initialized\n- Ready for new conversations`);
            updateAgentStatus(agent, 'ready');
        }

        function refreshAgent(agent) {
            updateAgentStatus(agent, 'working');
            setTimeout(() => {
                updateAgentStatus(agent, 'ready');
                const agentSelect = document.getElementById(`agent-${agent}-select`);
                if (agentSelect.value) {
                    const agentName = AGENT_CONFIG[agentSelect.value]?.name;
                    updateAgentResponse(agent, `##  Agent Refreshed\n\n**${agentName}** has been refreshed and is ready for collaboration.\n\n- Connection verified\n- System optimized\n- Performance enhanced`);
                }
            }, 1000);
        }

        function copyResponse(agent) {
            const responseElement = document.getElementById(`agent-${agent}-response`);
            const text = responseElement.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                const originalContent = responseElement.innerHTML;
                responseElement.innerHTML = `
                    <div style="text-align: center; color: var(--success); padding: 20px;">
                        <i class="fas fa-check" style="font-size: 24px; margin-bottom: 8px;"></i>
                        <h3> Response Copied!</h3>
                        <p>Agent response has been copied to your clipboard</p>
                    </div>
                `;
                setTimeout(() => {
                    responseElement.innerHTML = originalContent;
                }, 2000);
            }).catch(err => {
                alert('Failed to copy to clipboard. Please select and copy manually.');
            });
        }

        function editResponse(agent) {
            const responseElement = document.getElementById(`agent-${agent}-response`);
            const currentText = responseElement.textContent;
            const newText = prompt('Edit agent response:', currentText);
            if (newText !== null && newText.trim() !== '') {
                updateAgentResponse(agent, newText);
            }
        }

        function downloadResponse(agent) {
            const responseElement = document.getElementById(`agent-${agent}-response`);
            const text = responseElement.textContent;
            const agentName = AGENT_CONFIG[document.getElementById(`agent-${agent}-select`).value]?.name || `Agent ${agent.toUpperCase()}`;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${agentName.replace(/\s+/g, '_')}-response-${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function showSettings(agent) {
            const agentSelect = document.getElementById(`agent-${agent}-select`);
            const selectedAgent = agentSelect.value;
            if (selectedAgent) {
                const agentConfig = AGENT_CONFIG[selectedAgent];
                const settingsInfo = `
 Agent ${agent.toUpperCase()} Settings

 Configuration:
 Name: ${agentConfig.name}
 Model: ${agentConfig.model}
 Endpoint: ${agentConfig.endpoint}
 Status: Active

 Capabilities:
 Multi-agent collaboration
 Context-aware responses
 Real-time processing
 Export/import sessions

 Advanced settings and model fine-tuning coming soon!

Current session: ${currentSession || 'None'}
Total messages: ${messageCount}
`;
                alert(settingsInfo);
            } else {
                alert('Please select an agent first to view settings.');
            }
        }

        console.log(' PromptLink Enhanced - Clean design with section-based help system!');

        // ===== PAYMENT SYSTEM FUNCTIONS =====
        
        function showUpgradeModal() {
            document.getElementById('upgrade-modal').style.display = 'block';
        }
        
        function closeUpgradeModal() {
            document.getElementById('upgrade-modal').style.display = 'none';
        }
        
        function showLowCreditsModal() {
            document.getElementById('low-credits-modal').style.display = 'block';
        }
        
        function closeLowCreditsModal() {
            document.getElementById('low-credits-modal').style.display = 'none';
        }
        
        async function selectPlan(planId) {
            try {
                // Show loading state
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = 'Processing...';
                button.disabled = true;
                
                // Create Stripe checkout session
                const response = await fetch(`${API_BASE_URL}/api/payments/create-checkout`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        plan_id: planId,
                        email: 'user@example.com' // Replace with actual user email
                    })
                });
                
                const data = await response.json();
                
                if (data.status === 'success' && data.checkout_url) {
                    // Redirect to Stripe checkout
                    window.location.href = data.checkout_url;
                } else {
                    throw new Error(data.message || 'Failed to create checkout session');
                }
                
            } catch (error) {
                console.error('Payment error:', error);
                alert('Payment processing failed. Please try again.');
                
                // Reset button
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        async function updateCreditsDisplay() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/status`, {
                    headers: {
                        'X-User-ID': 'demo_user'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const creditsAmount = document.querySelector('.credits-amount');
                    if (creditsAmount) {
                        creditsAmount.textContent = data.credits.balance.toLocaleString();
                    }
                    
                    // Show low credits warning if below threshold
                    if (data.credits.balance < 500) {
                        showLowCreditsModal();
                    }
                }
            } catch (error) {
                console.error('Failed to update credits:', error);
            }
        }
        
        async function consumeCredits(agent, mode, message) {
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/consume-credits`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-User-ID': 'demo_user'
                    },
                    body: JSON.stringify({
                        agent: agent,
                        mode: mode,
                        message: message
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Update credits display
                    updateCreditsDisplay();
                    return true;
                } else if (response.status === 402) {
                    // Insufficient credits
                    showLowCreditsModal();
                    return false;
                } else {
                    throw new Error(data.error || 'Failed to consume credits');
                }
                
            } catch (error) {
                console.error('Credit consumption error:', error);
                return false;
            }
        }
        
        // Close modals when clicking outside
        window.onclick = function(event) {
            const upgradeModal = document.getElementById('upgrade-modal');
            const lowCreditsModal = document.getElementById('low-credits-modal');
            
            if (event.target === upgradeModal) {
                closeUpgradeModal();
            }
            if (event.target === lowCreditsModal) {
                closeLowCreditsModal();
            }
        }
        
        // Initialize credits display on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditsDisplay();
        });
    </script>

    <!-- ===== PAYMENT MODALS ===== -->
    
    <!-- Upgrade Modal -->
    <div id="upgrade-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2> Upgrade Your PromptLink Experience</h2>
                <button class="modal-close" onclick="closeUpgradeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="plans-grid">
                    <!-- Free Plan -->
                    <div class="plan-card" data-plan="free">
                        <div class="plan-badge free">FREE</div>
                        <div class="plan-header">
                            <h3>Free</h3>
                            <div class="plan-price">$0<span>/month</span></div>
                        </div>
                        <div class="plan-credits">100 Daily Credits</div>
                        <div class="plan-features">
                            <div class="feature"> 3 AI Agents</div>
                            <div class="feature"> Basic Orchestration</div>
                            <div class="feature"> Community Support</div>
                            <div class="feature"> Limited Export</div>
                        </div>
                        <button class="plan-btn" onclick="selectPlan('free')">Get Started Free</button>
                    </div>

                    <!-- Basic Plan -->
                    <div class="plan-card" data-plan="basic">
                        <div class="plan-header">
                            <h3>Basic</h3>
                            <div class="plan-price">$19<span>/month</span></div>
                        </div>
                        <div class="plan-credits">5,000 Credits</div>
                        <div class="plan-features">
                            <div class="feature"> 5 AI Agents</div>
                            <div class="feature"> Basic Orchestration</div>
                            <div class="feature"> Standard Support</div>
                            <div class="feature"> Export Conversations</div>
                        </div>
                        <button class="plan-btn" onclick="selectPlan('basic')">Choose Basic</button>
                    </div>

                    <!-- Professional Plan -->
                    <div class="plan-card featured" data-plan="professional">
                        <div class="plan-badge">Most Popular</div>
                        <div class="plan-header">
                            <h3>Professional</h3>
                            <div class="plan-price">$99<span>/month</span></div>
                        </div>
                        <div class="plan-credits">25,000 Credits</div>
                        <div class="plan-features">
                            <div class="feature"> 10+ AI Agents</div>
                            <div class="feature"> Advanced Orchestration</div>
                            <div class="feature"> Human Simulator</div>
                            <div class="feature"> Priority Support</div>
                            <div class="feature"> API Access</div>
                        </div>
                        <button class="plan-btn featured" onclick="selectPlan('professional')">Choose Professional</button>
                    </div>

                    <!-- Expert Plan -->
                    <div class="plan-card" data-plan="expert">
                        <div class="plan-header">
                            <h3>Expert</h3>
                            <div class="plan-price">$499<span>/month</span></div>
                        </div>
                        <div class="plan-credits">150,000 Credits</div>
                        <div class="plan-features">
                            <div class="feature"> All AI Agents</div>
                            <div class="feature"> AI Expert Master Persona</div>
                            <div class="feature"> Enterprise Features</div>
                            <div class="feature"> White-label Options</div>
                            <div class="feature"> Dedicated Support</div>
                        </div>
                        <button class="plan-btn" onclick="selectPlan('expert')">Choose Expert</button>
                    </div>
                </div>
                <div class="payment-security">
                    <i class="fas fa-lock"></i>
                    <span>Secure payment powered by Stripe</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Low Credits Modal -->
    <div id="low-credits-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2> Low Credits Warning</h2>
                <button class="modal-close" onclick="closeLowCreditsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="low-credits-message">
                    <p>You're running low on credits! Upgrade now to continue using all AI agents.</p>
                    <div class="credits-remaining">
                        <span class="credits-count">247</span> credits remaining
                    </div>
                </div>
                <div class="upgrade-options">
                    <button class="upgrade-option-btn" onclick="selectPlan('basic')">
                        <div class="option-title">Basic - $19/month</div>
                        <div class="option-credits">5,000 Credits</div>
                    </button>
                    <button class="upgrade-option-btn featured" onclick="selectPlan('professional')">
                        <div class="option-title">Professional - $99/month</div>
                        <div class="option-credits">25,000 Credits</div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
        }

        .modal-content {
            background: var(--card-bg);
            margin: 2% auto;
            padding: 0;
            border: 1px solid var(--separator-color);
            border-radius: 20px;
            width: 95%;
            max-width: 1200px;
            max-height: 95vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 32px;
            border-bottom: 1px solid var(--separator-color);
        }

        .modal-header h2 {
            margin: 0;
            color: var(--text-primary);
            font-size: 24px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 28px;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 32px;
        }

        .plans-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 20px;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--separator-color);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            transition: all 0.3s ease;
            min-height: auto;
            overflow: visible;
        }

        .plan-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 180, 216, 0.2);
            border-color: var(--accent-primary);
        }

        .plan-card h3 {
            font-size: 1.3rem;
            margin-bottom: 8px;
        }

        .plan-card .price {
            font-size: 2rem;
            margin-bottom: 12px;
        }

        .plan-card .features {
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .plan-card .features li {
            margin-bottom: 6px;
        }

        .plan-card .cta-button {
            padding: 10px 16px;
            font-size: 0.9rem;
            margin-top: 12px;
        }

        /* ===== HUMAN SIMULATOR STYLING ===== */
        .human-simulator-card {
            border: 2px solid var(--accent-primary);
            background: linear-gradient(135deg, rgba(0, 180, 216, 0.1), rgba(0, 212, 199, 0.1));
            box-shadow: 0 8px 32px rgba(0, 180, 216, 0.2);
        }

        .human-simulator-interface {
            padding: 20px;
        }

        .simulator-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(0, 180, 216, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(0, 180, 216, 0.3);
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-weight: 600;
            color: var(--accent-primary);
            font-size: 0.9rem;
        }

        .range-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--separator-color);
            outline: none;
            -webkit-appearance: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-primary);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 180, 216, 0.3);
        }

        .range-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-primary);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(0, 180, 216, 0.3);
        }

        #rounds-display {
            font-weight: bold;
            color: var(--accent-primary);
            font-size: 1.1rem;
            text-align: center;
            padding: 4px 8px;
            background: rgba(0, 180, 216, 0.2);
            border-radius: 6px;
            min-width: 30px;
        }

        .simulator-prompt-area {
            margin-bottom: 24px;
        }

        .simulator-prompt-area label {
            display: block;
            font-weight: 600;
            color: var(--accent-primary);
            margin-bottom: 8px;
        }

        .simulator-prompt-area textarea {
            width: 100%;
            min-height: 120px;
            padding: 16px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.95rem;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .simulator-prompt-area textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(0, 180, 216, 0.2);
        }

        .simulator-prompt-area textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .simulator-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .simulator-status {
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
        }

        .status-item {
            text-align: center;
        }

        .status-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--separator-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .simulator-controls {
                grid-template-columns: 1fr;
            }
            
            .simulator-actions {
                justify-content: center;
            }
            
            .status-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .plan-card.featured {
            border: 2px solid var(--accent-primary);
            box-shadow: 0 8px 24px rgba(0, 180, 216, 0.3);
        }

        .plan-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 6px 16px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .plan-badge.free {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
        }

        .plan-header h3 {
            margin: 0 0 8px 0;
            color: var(--text-primary);
            font-size: 20px;
            font-weight: 600;
        }

        .plan-price {
            font-size: 32px;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 8px;
        }

        .plan-price span {
            font-size: 16px;
            color: var(--text-muted);
            font-weight: 400;
        }

        .plan-credits {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-weight: 500;
        }

        .plan-features {
            margin-bottom: 24px;
        }

        .feature {
            padding: 6px 0;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .plan-btn {
            width: 100%;
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--separator-color);
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .plan-btn:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .plan-btn.featured {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            color: white;
        }

        .plan-btn.featured:hover {
            background: linear-gradient(135deg, var(--accent-secondary), var(--accent-primary));
        }

        .payment-security {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: var(--text-muted);
            font-size: 14px;
            margin-top: 24px;
        }

        .low-credits-message {
            text-align: center;
            margin-bottom: 32px;
        }

        .low-credits-message p {
            color: var(--text-secondary);
            font-size: 16px;
            margin-bottom: 16px;
        }

        .credits-remaining {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid #ffc107;
            border-radius: 12px;
            padding: 12px 24px;
            display: inline-block;
        }

        .credits-count {
            font-size: 24px;
            font-weight: 700;
            color: #ffc107;
        }

        .upgrade-options {
            display: flex;
            gap: 16px;
            justify-content: center;
        }

        .upgrade-option-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--separator-color);
            border-radius: 12px;
            padding: 16px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-width: 200px;
        }

        .upgrade-option-btn:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .upgrade-option-btn.featured {
            border: 2px solid var(--accent-primary);
            background: rgba(0, 180, 216, 0.1);
        }

        .option-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .option-credits {
            font-size: 14px;
            color: var(--text-muted);
        }
    </style>

</body>
</html>
